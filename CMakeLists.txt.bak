cmake_minimum_required(VERSION 3.0)
project(gazebo_wind_field)
find_package(gazebo REQUIRED)
find_package(Protobuf REQUIRED)

###############################
##### Protobuf messages #######
###############################
set(PROTOBUF_IMPORT_DIRS "")
foreach(ITR ${GAZEBO_INCLUDE_DIRS})
  if(ITR MATCHES ".*gazebo-[0-9.]+$")
    set(PROTOBUF_IMPORT_DIRS "${ITR}/gazebo/msgs/proto")
  endif()
endforeach()

set (msgs
  #${CMAKE_SOURCE_DIR}/msgs/Wind.proto
  # KITEPOWER (Xander)
  ${CMAKE_SOURCE_DIR}/msgs/WindField.proto
  ${PROTOBUF_IMPORT_DIRS}/time.proto
  ${PROTOBUF_IMPORT_DIRS}/vector3d.proto
)

message("The messages" ${msgs})
PROTOBUF_GENERATE_CPP(PROTO_SRCS PROTO_HDRS ${msgs})
message(The PROTO_SRCS is at ${PROTO_SRCS})
message(The PROTO_HDRS is at ${PROTO_HDRS})



########################################
########## Include and link directories ###
############################################
include_directories(${GAZEBO_INCLUDE_DIRS})
include_directories(${CMAKE_BINARY_DIR})
########################
### Link Directories ###
########################
link_directories(${GAZEBO_LIBRARY_DIRS})
list(APPEND CMAKE_CXX_FLAGS "${GAZEBO_CXX_FLAGS}")
include_directories(include)

##############################################################################################
### Add a library target called gazebo_wind_field to be built from the source files listed ###
##############################################################################################
add_library(gazebo_wind_field SHARED WindPlugin.cc) # add a library to the project using specified source files
target_include_directories(
    gazebo_wind_field
    PRIVATE ${CMAKE_SOURCE_DIR}/msgs
    )

target_include_directories(
    gazebo_wind_field
    PRIVATE ${CMAKE_BINARY_DIR}
    )

target_link_libraries(gazebo_wind_field ${GAZEBO_LIBRARIES})
target_link_libraries(gazebo_wind_field ${PROTOBUF_LIBRARY})
